#第4章 字典
字典是Python中唯一内建的映射类型，key可以是数字，字符串甚至元组  
字典就类似Java里面的map

## 4.1 字典的用途
一些字典的用途：  
+ 表示棋盘的状态，一个键是一个由坐标组成的元组
+ 存储文件的修改时间，键是文件名
+ 数字电话/地址簿

## 4.2创建和使用字典
```python
phonebook = {'Alice': '2341', 'Beth': '9102', "Cecil": '3258'}
print(phonebook['Cecil'])
```

### 4.2.1 dict函数
```python
# 可以通过dict，用其他映射或者key value这样的序列来建立字典
items = [('name', 'Gumby'), ('age', 42)]
d = dict(items)
print(d) # {'name': 'Gumby', 'age': 42}
print(d['name'])
# 也可以通过关键字参数来创建字典
d = dict(name='Gumby', age=42)
print(d) # {'name': 'Gumby', 'age': 42}

```
```python
# 可以创建字典来嵌套字典
dic1 = {"name": "zjx"}
dic2 = {"info": dic1}
print(dic2["info"]['name']) # zjx
```
### 4.2.2基本字典操作
字典基本行为和序列类似
+ len(d) 返回键值对的数量
+ d[k] 返回对应key的value
+ d[k]=v 将value关联到key
+ del d[k] 删除key为k的项
+ k in d 检查是否有key为k的项

字典和列表的区别
+ key的类型：可能是整型，或其他不可变类型：浮点型、字符串、元组
+ 自动添加：可以给不存在的key关联value，而列表不行
+ 成员资格：k in d检查的是key是否存在，可以根据key找到对应的value

### 4.2.3 将字符串格式设置功能用于字典
```python
phonebook = {'Beth': '9102', 'Alice': '2341', 'Cecil': '3258'}
#  通过在%后加上(key)可以方便得处理字典
print("Cecil's phone number is %(Cecil)s.".format_map(phonebook))

# 这种方式在模板中非常有用，我觉得感觉有点儿和js里面的解构似的
template = '''<html>
<head><title>{title}</title></head>
<body>
<h1>{title}</h1>
<p>{text}</p>
</body>
'''
data = {"title": "My home page", "text": "欢迎"}
print(template.format_map(data))
```
### 4.2.4 字典方法
#### clear 清除字典中所有项
```python
# 对当前字典进行操作，没有返回值
d = {}
d['name'] = 'zjx'
d["age"] = 26
print(d) # {'name': 'zjx', 'age': 26}
d.clear()
print(d) # {}
``` 
#### copy返回一个具有相同键值对的新字典(浅复制)
```python
x = {'username': 'admin', 'machines': ['foo', 'bar', 'baz']}
y = x.copy()
y['username'] = 'root'
y['machines'].remove('bar')
print(y)  # {'username': 'root', 'machines': ['foo', 'baz']}
print(x)  # {'username': 'admin', 'machines': ['foo', 'baz']}
# 当在副本中替换值的时候，原始字典不受影响，但是如果对某个值原地修改，原始的字典也会被改变

# 可以使用深拷贝来解决
from copy import deepcopy

d = {}
d['names'] = ['zjx', 'ckx']
c = d.copy()
dc = deepcopy(d)
d['names'].append('dsh')
print(c) # {'names': ['zjx', 'ckx', 'dsh']}
print(dc)  # 不会受到原字典修改的影响 {'names': ['zjx', 'ckx']}
```

#### fromkeys 用给定的key创建新的字典，默认值设置为None
```python
dict.fromkeys(['name', 'age'])  # {'name': None, 'age': None}
# 可以自己指定默认值
dict.fromkeys(["name", "age"], 'undefined')
```


#### get
如果直接访问字典中没有的项，将引发错误，而get不会
```python
d = {}
print(d['name'])

Traceback (most recent call last):
File "<stdin>", line 1, in ?
KeyError: 'name'
```
```python
d = {}
# 对应没有的key返回None
print(d.get('name'))
# 可以设置get不到时候返回的默认值
print(d.get("name", "没有啊"))
# 正常使用
d['name'] = 'zjx'
print(d.get("name"))
```


#### items
返回一个包含所有字典项的列表，其中每个元素都为(key, value)的形式。字典项
在列表中的排列**顺序不确定**。
```python
# items将所有键值对 可以用for遍历
d = {'title': 'Python Web Site', 'url': 'www.python.org', 'spam': 0}
for item in d.items():
    print(item)
```
```python
# 返回值属于一种名为字典视图的特殊类型。字典视图可用于迭代。
# dict_items([('url', 'http://www.python.org'), ('spam', 0), ('title', 'Python Web Site')])
# 视图的一个优点是不复制，它们始终是底层字典的反映，即便你修改了底层字典亦如此。
>>> d['spam'] = 1
>>> ('spam', 0) in it
False
>>> d['spam'] = 0
>>> ('spam', 0) in it
True
```


#### keys
```python
d = {'title': 'Python Web Site', 'url': 'www.python.org', 'spam': 0}
print(type(d.keys()))
```


#### pop
```python
# 获取对应给定key的值，然后从字典中移除
d = {'x': 1, 'y': 2}
print(d.pop('x'))  # 1
print(d)  # {'y': 2}
```


#### popitem
```python
d = {'x': 1, 'y': 2}
# 弹出随机的元素
print(d.popitem())
# print(d.popitem()) #空字典调用会抛异常
```


#### setdefault
```python
# 类似get，但是可以在不含给定key的时候设置相应的值
d = {}
print(d.setdefault('name', 'N/A'))  # 获取key对应的value，如果没有就设置成N/A并返回
print(d)
```

#### update
利用一个字典项更新另外一个字典
```python
d = {
    'title': 'python website',
    'url': 'http://www.python.org',
    'changed': 'Mar 14'
}
x = {
    'title':'Python Language Website'
}
d.update(x)
print(d) #会将x加入到d字典里，有相同的key则覆盖
```

#### values
```python
#以dict_values类对象的形式返回values
d = {
    'title': 'python website',
    'url': 'http://www.python.org',
    'changed': 'Mar 14'
}
print(type(d.values())) # <class 'dict_values'>
print(d.values()) # dict_values(['python website', 'http://www.python.org', 'Mar 14'])
```

## 4.3 小结
+ 映射：映射让你可以使用任何不可变的对象（最常用的是字符串和元组）来标识元素。  
Python里只有一种内置的映射类型，就是字典
+ 将字符串格式设置功能用于字典：要对字典执行字符串格式设置操作，不能使用format和命名参数，而必须使用format_map
+ 字典方法：字典有很多方法，这些方法的调用方式与列表和字符串的方法相同

